<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Miyotl Products ‚Äî Hechos a mano, pensando en tu piel</title>
  <meta name="description" content="Jabones artesanales de glicerina. F√≥rmulas limpias, consistentes y honestas.">
  <style>
    :root{
      /* Paleta aproximada extra√≠da del logo */
      --brand-50:#F7EFE6;   /* beige fondo */
      --brand-100:#F2E6D8;
      --brand-200:#EAD6C0;
      --brand-300:#DBBFA2;
      --brand-400:#C9A781;
      --brand-500:#2B0F3A;  /* morado tipograf√≠a */
      --brand-600:#221030;
      --brand-700:#1B0D28;
      --brand-800:#140A1F;
      --brand-900:#0E0717;
      --accent:#E04493;     /* magenta isotipo */
	  --miyotl-purple:#C53D8C;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial;
      color:var(--brand-900); background:#fff;
    }
    .container{max-width:1120px;margin:0 auto;padding:0 16px}
   /* --- Banner encabezado (sin recortes, fondo beige detr√°s) --- */
.top-banner{
  width: 100%;
  height: clamp(140px, 24vh, 320px); /* altura adaptable */
  display: block;
  object-fit: contain;             /* muestra la imagen completa sin recortes */
  object-position: center;
  background-color: var(--brand-50); /* usa tu beige #F7EFE6 */
  max-width: 100%;
  filter: saturate(0.95);
  margin: 0;
  padding: 0;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}


    .nav-under-banner{
  display:flex;
  gap:10px;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
  padding:12px 16px;
  border-bottom:1px solid var(--brand-200);
  background: var(--brand-50); /* mismo beige que el banner: #F7EFE6 */
}

    .nav-under-banner a, .nav-under-banner button{
      appearance:none;border:1px solid var(--brand-300); background:#fff; color:var(--brand-800);
      padding:8px 12px; border-radius:12px; font-size:14px; cursor:pointer;
      transition:.15s border-color,.15s color,.15s transform; text-decoration:none;
    }
    .nav-under-banner a:hover, .nav-under-banner button:hover{
      border-color:var(--brand-500); color:var(--brand-900); transform:translateY(-1px)
    }
	/* Botones del banner en morado Miyotl */
.nav-under-banner a,
.nav-under-banner button{
background: var(--miyotl-purple);
color: #fff;
border-color: #A83477;

}
    .hero{
	background:#e1d1bd;   /* nuevo fondo (H33 S16 B88) */
	padding:48px 0 64px;
    }
	.hero h1{font-size:38px;line-height:1.15;margin:0 0 12px;font-weight:900;text-align:center;color:var(--miyotl-purple)}
    @media(min-width:768px){.hero h1{font-size:56px}}
    .hero p{color:var(--brand-800);font-size:18px;margin:0 0 50px;text-align:center}
    .pill{display:inline-block;background:#fff;border:1px solid var(--brand-200);padding:6px 10px;border-radius:10px;margin-right:8px;color:var(--brand-700);font-size:13px}
    .btn{
      appearance:none;border:0;border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer;
      color:#fff;background:var(--brand-600);box-shadow:0 2px 8px rgba(0,0,0,.08);
    }
    .btn:hover{background:var(--brand-700)}
    .btn.secondary{background:#fff;color:var(--brand-800);border:1px solid var(--brand-300)}
    .grid4{display:grid;gap:16px}
    @media(min-width:768px){.grid4{grid-template-columns:repeat(4,1fr)}}
    .card{
      background:#fff;border:1px solid var(--brand-200);border-radius:18px;padding:20px;
      transition:.15s transform,.15s border-color; box-shadow:0 2px 12px rgba(0,0,0,.04)
    }
    .card:hover{
	transform: translateY(-2px);
	border-color: var(--brand-400);
	}
     /* Bullets horizontales (secci√≥n de confianza) */
.confidence{
  background: inherit;
  padding: 12px 0 18px;     /* +aire vertical */
  margin: 16px 0 40px;      /* separa del footer */
}
.confidence .container{
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;   /* centro real */
  gap: 24px;                 /* +aire entre bullets */
}
.confidence .card{
  background: transparent;
  border: 0;
  box-shadow: none;
  padding: 0;
  margin: 0;
  border-radius: 0;
  display: flex;
  align-items: baseline;
  gap: 6px;
  text-align: center;        /* centra texto de cada √≠tem */
  line-height: 1.4;          /* +aire interno */
}
.confidence .card::before{
  content: "‚Ä¢";
  font-weight: 700;
  color: var(--brand-400);
  margin-right: 2px;
}
.confidence .card > div{ display: inline; }
.confidence .card > div:first-child{ font-weight: 700; margin-right: 6px; }
.confidence .card .muted{ color: var(--brand-700); font-weight: 400; }

/* Cada item como bullet */
.confidence .card{
  background: transparent;
  border: 0;
  box-shadow: none;
  padding: 0;
  margin: 0;
  border-radius: 0;
  display: flex;
  align-items: baseline;
  gap: 6px;
}
.confidence .card::before{
  content: "‚Ä¢";
  font-weight: 700;
  color: var(--brand-400);
  margin-right: 2px;
}
.confidence .card > div{ display: inline; }
.confidence .card > div:first-child{ font-weight: 700; margin-right: 6px; }
.confidence .card .muted{ color: var(--brand-700); font-weight: 400; }
     /* Modal: oculto por defecto */
.modal{
  position:fixed;
  inset:0;
  display:none;                 /* <-- clave: oculto */
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.35);
  padding:20px;
  z-index:1000;
}
.modal.open{ display:flex; }
    }
    .table{width:100%;border-collapse:collapse;font-size:14px}
    .table th,.table td{padding:10px;border-top:1px solid #eee;text-align:left}
    .table thead th{background:var(--brand-50);color:var(--brand-800);border-top:none}
    .input, select{
      width:100%;padding:9px 10px;border:1px solid var(--brand-300);border-radius:10px;background:#fff;
    }
    .right{text-align:right}
    .muted{color:var(--brand-700);font-size:13px}
    .accent{color:var(--accent)}
	/* --- Color morado para Sign in --- */
    :root { --miyotl-purple: #C53D8C; }  /* RGB(197,61,140) */

    /* (opcional) morado tambi√©n para el link ‚ÄúSoy nuevo‚Äù */
    header .new-link{ color: var(--miyotl-purple); }
	/* Sign in sobre el banner (arriba-derecha) */
    header { position: relative; }
	  header{
  position: relative;
  background-color: var(--brand-50); /* beige detr√°s del banner */
}

    header .signin-wrap{
      position:absolute;
		right:16px;
		bottom:16px;   /* ancla abajo */
		top:auto;      /* cancela cualquier 'top' previo */
		display:flex;
		flex-direction:column;
		gap:6px;
		align-items:center;
		text-align:center;
		z-index:5;
}

    header .btn-signin{
      display:inline-block;
      appearance:none;
      border:0; border-radius:12px; padding:10px 14px;
      font-weight:700; cursor:pointer;
      color:#fff; background:var(--miyotl-purple);
      box-shadow:0 2px 8px rgba(0,0,0,.08);
      text-decoration:none;
    }
    header .btn-signin:hover{ background:#A83477; }

    header .new-link{
      font-size:12px; color:var(--miyotl-purple);
      text-decoration:underline;
    }
	/* === Triptych central (3 im√°genes verticales) === */
.triptych-wrap{
  background:#fff;
  padding:32px 0 48px;
  border-top:1px solid var(--brand-100);
}

.triptych{
  display:grid;
  gap:16px;
  grid-template-columns: 1fr;      /* m√≥vil: 1 columna */
  justify-items:center;            /* centra cada imagen */
}

.triptych figure{
  margin:0;
  width:100%;
  max-width:420px;                 /* ancho m√°x por imagen en m√≥vil/tablet */
}

.triptych img{
  display:block;
  width:100%;
  height:auto;
  aspect-ratio:3/4;                /* vertical 3:4 */
  object-fit:cover;
  border-radius:18px;
  box-shadow:0 6px 24px rgba(0,0,0,.08);
}

/* Desktop: 3 columnas */
@media (min-width:900px){
  .triptych{
    grid-template-columns:repeat(3,minmax(0,1fr));
    gap:24px;
  }
  .triptych figure{
    max-width:100%;
  }
}
footer{ padding: 16px 0 28px; border-top: 1px solid var(--brand-100); }
/* ---- Registro (reusa variables y look & feel) ---- */
.sheet{
  background:#fff; border:1px solid var(--brand-200); border-radius:18px;
  padding:16px; max-width:840px; width:100%; box-shadow:0 10px 30px rgba(0,0,0,.12);
}
.form-grid{
  display:grid; gap:12px;
  grid-template-columns: 1fr;
}
@media (min-width:760px){
  .form-grid{ grid-template-columns: repeat(2, 1fr); }
  .span-2{ grid-column: 1 / span 2; }
}
.form-note{ font-size:13px; color:var(--brand-700); }
.form-title{ margin:0 0 8px; font-size:18px; color:var(--brand-600); }
.success-box{
  border:1px solid var(--brand-300); background:var(--brand-50);
  border-radius:12px; padding:12px; margin-top:12px;
}
.badge{
  display:inline-block; font-size:12px; padding:3px 8px; border-radius:999px;
  background:#fff; border:1px solid var(--brand-300); color:var(--brand-700);
}
  </style>
</head>
<body>

<!-- Banner encabezado (usa tu imagen larga con hojas) -->
<header>
  <img class="top-banner"
     src="assets/images/LogolargoMiyotl1.webp"
     alt="Miyotl Products ‚Äî banner principal"
     width="1920" height="320">
  <!-- Botones debajo del banner, en l√≠nea horizontal -->
<div class="nav-under-banner">
	<a href="nosotros.html">Nosotros</a>
	<a href="catalogo.html">Cat√°logo</a>
	<a href="politicas.html">Pol√≠ticas</a>
	<a href="aviso.html">Aviso de privacidad</a>
	<a href="faq.html">Preguntas frecuentes</a>
</div>
</header>

<section class="hero">
  <div class="container" style="display:grid;gap:28px;align-items:center;grid-template-columns:1fr">
    <div>
      <h1>Jabones artesanales de glicerina</h1>
      <p>F√≥rmulas limpias, consistencia de laboratorio y un trato honesto.</p>

      <!-- Triptych DENTRO del hero -->
      <div class="triptych">
        <figure>
          <img src="assets/images/gal-1.webp" alt="Miyotl ‚Äî detalle de jab√≥n artesanal" width="1200" height="1600" loading="lazy" decoding="async">
        </figure>
        <figure>
          <img src="assets/images/gal-2.webp" alt="Miyotl ‚Äî selecci√≥n de aromas" width="1200" height="1600" loading="lazy" decoding="async">
        </figure>
        <figure>
          <img src="assets/images/gal-3.webp" alt="Miyotl ‚Äî presentaci√≥n en punto de venta" width="1200" height="1600" loading="lazy" decoding="async">
        </figure>
      </div>
      <!-- /Triptych -->
    </div>
  </div>
</section>


<section class="confidence">
  <div class="container" style="display:flex;gap:16px;flex-wrap:wrap;justify-content:center;align-items:center">
    <div class="card">
      <div style="font-weight:700">Entregas confiables</div>
     </div>
    <div class="card">
      <div style="font-weight:700">F√≥rmulas limpias</div>
      <div class="muted">Transparencia de ingredientes y lotes artesanales.</div>
    </div>
    <div class="card">
      <div style="font-weight:700">Precio justo</div>
      <div class="muted">Precios claros y consistentes.</div>
    </div>
  </div>
</section>

<footer>
  <div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:12px">
    <div>¬© <span id="year"></span> Miyotl Products ¬∑ Hecho en M√©xico</div>
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <a href="#aviso">Aviso de privacidad</a>
      <a href="#politicas">Pol√≠ticas</a>
      <a href="mailto:Miyotlproducts@gmail.com?subject=Contacto%20desde%20miyotl.mx">Contacto</a>
      <a href="#" id="open-quote2">Cotizador</a>
    </div>
  </div>
</footer>
<!-- Modal Registro -->
<div class="modal" id="reg-modal">
  <div class="sheet">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
      <h3 class="form-title">Registro de cliente</h3>
      <button class="btn secondary" id="reg-close">Cerrar</button>
    </div>

    <form id="reg-form" novalidate>
      <div class="form-grid">
        <label>Nombre completo*
          <input class="input" name="nombre" required placeholder="Nombre y apellidos">
        </label>

        <label>Tel√©fono (10 d√≠gitos)*
          <input class="input" name="telefono" required inputmode="numeric" pattern="\d{10}" placeholder="5512345678">
        </label>

        <label>Correo electr√≥nico*
          <input class="input" name="email" type="email" required placeholder="tu@correo.com">
        </label>

        <label class="span-2">Calle*
          <input class="input" name="calle" required placeholder="Av. Siempre Viva">
        </label>

        <label>N√∫mero exterior*
          <input class="input" name="numext" required placeholder="123">
        </label>

        <label>N√∫mero interior (opcional)
          <input class="input" name="numint" placeholder="Depto / Interior">
        </label>

        <label>Colonia*
          <input class="input" name="colonia" required>
        </label>

        <label>Municipio / Alcald√≠a*
          <input class="input" name="municipio" required>
        </label>

        <label>Estado*
          <input class="input" name="estado" required>
        </label>

        <label>C√≥digo postal (5 d√≠gitos)*
          <input class="input" name="cp" required inputmode="numeric" pattern="\d{5}">
        </label>

        <label class="span-2">Tipo de cliente*
          <select class="input" name="tipo" id="tipo-cliente" required>
            <option value="Minorista" selected>Minorista</option>
            <option value="Concesionario">Concesionario</option>
            <option value="Mayorista">Mayorista</option>
            <option value="Distribuidor">Distribuidor</option>
          </select>
        </label>

        <!-- Contratos din√°micos -->
        <div class="span-2" id="contrato-wrap" style="display:none">
          <div class="form-note" style="margin-bottom:6px">
            Para <span id="tipo-label" class="badge">‚Äî</span> debes leer y aceptar el contrato correspondiente.
          </div>

          <!-- Cambia estos href a tus PDFs reales -->
          <div id="contrato-link" class="form-note" style="margin-bottom:8px">
			<a href="#" target="_blank" rel="noopener" id="contrato-url">Ver contrato</a>
		</div>
		<iframe id="contrato-embed" title="Contrato" style="width:100%;height:300px;border:1px solid var(--brand-200);border-radius:10px;display:none"></iframe>


          <label style="display:flex;gap:8px;align-items:flex-start">
            <input type="checkbox" id="chk-contrato">
            <span>He le√≠do, acepto y autorizo el contrato de <strong id="tipo-strong">‚Äî</strong>.</span>
          </label>
        </div>

        <label class="span-2" style="display:flex;gap:8px;align-items:flex-start">
          <input type="checkbox" id="chk-promos">
          <span>Autorizo recibir promociones y boletines.</span>
        </label>

        <label class="span-2" style="display:flex;gap:8px;align-items:flex-start">
          <input type="checkbox" id="chk-priv" required>
          <span>Acepto las <a href="politicas.html" target="_blank" rel="noopener">Pol√≠ticas</a> y el <a href="aviso.html" target="_blank" rel="noopener">Aviso de privacidad</a>.*</span>
        </label>
      </div>

      <div class="form-note">* Campo obligatorio. El n√∫mero interior es opcional.</div>

      <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:12px">
        <button type="button" class="btn secondary" id="reg-clear">Limpiar</button>
        <button type="submit" class="btn" id="reg-send">Registrarme</button>
      </div>

      <div id="reg-result" class="success-box" style="display:none"></div>
    </form>
  </div>
</div>
<!-- /Modal Registro -->

<!-- Modal Cotizador -->
<div class="modal" id="modal">
  <div class="sheet">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
      <h3 style="margin:0;font-size:18px">Cotizador</h3>
      <button class="btn secondary" id="close-modal">Cerrar</button>
    </div>

    <div class="muted" style="margin:6px 0 12px">
      Precios mostrados <strong>sin IVA</strong>. Packs por l√≠nea: <strong>3 = ‚àí10%</strong>, <strong>6 = ‚àí16%</strong>.
    </div>

    <div style="display:grid;gap:12px;grid-template-columns:1fr 2fr;margin-bottom:12px">
      <label>Rol
        <select id="rol" class="input">
          <option>Consignatario</option>
          <option selected>Mayorista</option>
          <option>Distribuidor</option>
        </select>
      </label>
      <label>Correo para copia (opcional)
        <input class="input" id="email-cc" type="email" placeholder="tu.correo@dominio.com">
      </label>
    </div>

    <div style="overflow:auto;border:1px solid var(--brand-200);border-radius:12px">
      <table class="table" id="table">
        <thead>
          <tr>
            <th>SKU</th>
            <th>Precio unit. (sin IVA)</th>
            <th>Cantidad</th>
            <th class="right">Importe</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
      <div style="display:flex;align-items:center;justify-content:space-between;padding:8px 12px">
        <button class="muted" id="add-line" style="background:none;border:0;cursor:pointer">+ agregar l√≠nea</button>
        <div class="right" style="font-size:14px">
          <div>Subtotal (sin IVA): <strong id="sub"></strong></div>
          <div>IVA 16%: <strong id="iva"></strong></div>
          <div style="font-size:16px">Total: <strong id="tot"></strong></div>
        </div>
      </div>
    </div>

    <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:12px">
      <button class="btn secondary" id="clear">Limpiar</button>
      <button class="btn" id="send">Enviar cotizaci√≥n</button>
    </div>
  </div>
</div>

<script>
  const $ = (s)=>document.querySelector(s);
  const fmt = (n)=>n.toLocaleString('es-MX',{style:'currency',currency:'MXN'});
  const byId = (id)=>document.getElementById(id);

  // Cat√°logo (ajusta con tu Anexo A)
  const SKUS = [
    {id:'BAR-100', nombre:'Jab√≥n de glicerina 100 g', unidad:'pza',
     precios:{Consignatario:60, Mayorista:50, Distribuidor:40}},
    {id:'COR-1L', nombre:'Jab√≥n corporal 1 L', unidad:'botella',
     precios:{Consignatario:110, Mayorista:100, Distribuidor:80}},
    {id:'ESS-100', nombre:'Esencia 100 ml', unidad:'frasco',
     precios:{Consignatario:180, Mayorista:175, Distribuidor:140}},
    {id:'SHAM-1L', nombre:'Shampoo 1 L', unidad:'botella',
     precios:{Consignatario:320, Mayorista:299, Distribuidor:299}} // excepci√≥n
  ];

  function unitPrice(rol, skuId){
    const sku = SKUS.find(s=>s.id===skuId);
    return sku ? sku.precios[rol] : 0;
  }

  // Descuento por packs: 6‚Üí‚àí16%, 3‚Üí‚àí10%, resto sin descuento
  function lineTotal(qty, unit){
    const packs6 = Math.floor(qty/6);
    const rem6 = qty%6;
    const packs3 = Math.floor(rem6/3);
    const rem = rem6%3;
    return packs6*(6*unit*0.84) + packs3*(3*unit*0.90) + rem*unit;
  }

  const tbody = byId('tbody');
  const rolSel = byId('rol');
  let rows = [{skuId:'BAR-100', qty:6}];

  function render(){
    tbody.innerHTML = '';
    const rol = rolSel.value;
    let subtotal = 0;
    rows.forEach((r, i)=>{
      const unit = unitPrice(rol, r.skuId);
      const imp = lineTotal(r.qty, unit);
      subtotal += imp;
      const tr = document.createElement('tr');

      const tdSku = document.createElement('td');
      const sel = document.createElement('select');
      sel.className='input';
      SKUS.forEach(s=>{
        const opt = document.createElement('option');
        opt.value=s.id; opt.textContent=`${s.id} ‚Äî ${s.nombre}`;
        if(s.id===r.skuId) opt.selected=true;
        sel.appendChild(opt);
      });
      sel.onchange = e=>{ rows[i].skuId = e.target.value; render(); };
      tdSku.appendChild(sel);

      const tdUnit = document.createElement('td');
      tdUnit.textContent = fmt(unit);

      const tdQty = document.createElement('td');
      const input = document.createElement('input');
      input.type='number'; input.min='0'; input.value=r.qty; input.className='input';
      input.oninput = e=>{ rows[i].qty = Math.max(0, Math.floor(Number(e.target.value)||0)); render(); };
      tdQty.appendChild(input);

      const tdImp = document.createElement('td'); tdImp.className='right'; tdImp.textContent=fmt(imp);

      const tdRm = document.createElement('td');
      if(rows.length>1){
        const btn = document.createElement('button');
        btn.textContent='‚úï'; btn.className='muted';
        btn.style.border='0'; btn.style.background='none'; btn.style.cursor='pointer';
        btn.onclick = ()=>{ rows = rows.filter((_,idx)=>idx!==i); render(); };
        tdRm.appendChild(btn);
      }

      tr.append(tdSku, tdUnit, tdQty, tdImp, tdRm);
      tbody.appendChild(tr);
    });

    byId('sub').textContent = fmt(subtotal);
    const iva = subtotal*0.16;
    byId('iva').textContent = fmt(iva);
    byId('tot').textContent = fmt(subtotal+iva);
  }

  byId('add-line').onclick = ()=>{ rows.push({skuId:'BAR-100', qty:1}); render(); };
  byId('clear').onclick = ()=>{ rows = [{skuId:'BAR-100', qty:6}]; render(); };

  const modal = byId('modal');
  const openers = [byId('open-quote'), byId('open-quote2'), byId('cta-quote')];
  openers.forEach(btn=>btn && (btn.onclick = ()=>{ modal.classList.add('open'); render(); }));
  byId('close-modal').onclick = ()=> modal.classList.remove('open');

  byId('send').onclick = ()=>{
    const rol = rolSel.value;
    let lines = rows.map(r=>{
      const s = SKUS.find(x=>x.id===r.skuId);
      const unit = unitPrice(rol, r.skuId);
      const imp = lineTotal(r.qty, unit);
      return `${s.id} ‚Äî ${s.nombre} | ${r.qty} √ó ${fmt(unit)} = ${fmt(imp)}`;
    }).join('%0A');
    const sub = document.getElementById('sub').textContent;
    const iva = document.getElementById('iva').textContent;
    const tot = document.getElementById('tot').textContent;
    const cc = (byId('email-cc').value||'').trim();
    const subject = encodeURIComponent(`Cotizaci√≥n (${rol}) ‚Äî Miyotl`);
    const body = `Rol: ${rol}%0A%0A${lines}%0A%0ASubtotal (sin IVA): ${sub}%0AIVA 16%: ${iva}%0ATotal: ${tot}%0A%0AContacto:%0ANombre:%20______________%0ATel√©fono:%20______________%0ADirecci√≥n:%20______________`;
    const mailto = `mailto:Miyotlproducts@gmail.com?subject=${subject}&body=${body}` + (cc?`&cc=${encodeURIComponent(cc)}`:'');
    window.location.href = mailto;
  };
/** ===== Registro (abrir/cerrar, validaci√≥n, env√≠o) ===== **/
const REG_MAIL = "Miyotlproducts@gmail.com";
const APP_SCRIPT_ENDPOINT = "";        // sin uso
const SAVE_LOCAL_BACKUP = false;       // no guardamos nada en el navegador

const regModal = document.getElementById('reg-modal');
const openRegBtn = document.getElementById('open-register');
const closeRegBtn = document.getElementById('reg-close');
const regForm   = document.getElementById('reg-form');

const tipoSel       = document.getElementById('tipo-cliente');
const contratoWrap  = document.getElementById('contrato-wrap');
const contratoUrl   = document.getElementById('contrato-url');
const contratoChk   = document.getElementById('chk-contrato');
const tipoBadge     = document.getElementById('tipo-label');
const tipoStrong    = document.getElementById('tipo-strong');
const promosChk     = document.getElementById('chk-promos');
const privChk       = document.getElementById('chk-priv');
const regClear      = document.getElementById('reg-clear');
const regResult     = document.getElementById('reg-result');

const CONTRATOS = {
  "Concesionario": "assets/contracts/contrato-concesionario.pdf",
  "Mayorista":     "assets/contracts/contrato-mayorista.pdf",
  "Distribuidor":  "assets/contracts/contrato-distribuidor.pdf"
};

function openReg(){ regModal.classList.add('open'); }
function closeReg(){ regModal.classList.remove('open'); }
// Cerrar modal al hacer clic en el fondo (backdrop)
regModal.addEventListener('click', (e)=>{
  if (e.target === regModal) closeReg();
});
// Cerrar modal con la tecla ESC
document.addEventListener('keydown', (e)=>{
  if (e.key === 'Escape' && regModal.classList.contains('open')) {
    closeReg();
  }
});

if (openRegBtn) openRegBtn.onclick = (e)=>{ e.preventDefault(); openReg(); };
if (closeRegBtn) closeRegBtn.onclick = (e)=>{ e.preventDefault(); closeReg(); };

// Mostrar/ocultar contrato seg√∫n tipo elegido
function refreshContratoUI(){
  const t = (tipoSel?.value)||'Minorista';
  const iframe = document.getElementById('contrato-embed');
  if (t === 'Minorista'){
    contratoWrap.style.display = 'none';
    contratoChk.checked = false;
    if (iframe){ iframe.style.display = 'none'; iframe.removeAttribute('src'); }
  } else {
    contratoWrap.style.display = '';
    tipoBadge.textContent = t;
    tipoStrong.textContent = t;
    const url = CONTRATOS[t] || "#";
    contratoUrl.href = url;
    if (iframe && url !== "#"){ iframe.src = url; iframe.style.display = 'block'; }
  }
}

if (tipoSel){
  tipoSel.onchange = refreshContratoUI;
  refreshContratoUI();
}

// Env√≠o
regForm?.addEventListener('submit', async (e)=>{
  e.preventDefault();
  regResult.style.display = 'none';

  const fd = new FormData(regForm);
  const data = {
    nombre:   (fd.get('nombre')||'').trim(),
    telefono: (fd.get('telefono')||'').trim(),
    email:    (fd.get('email')||'').trim(),
    calle:    (fd.get('calle')||'').trim(),
    numext:   (fd.get('numext')||'').trim(),
    numint:   (fd.get('numint')||'').trim(),
    colonia:  (fd.get('colonia')||'').trim(),
    municipio:(fd.get('municipio')||'').trim(),
    estado:   (fd.get('estado')||'').trim(),
    cp:       (fd.get('cp')||'').trim(),
    tipo:     (fd.get('tipo')||'').trim(),
    promos:   promosChk.checked ? 'S√≠' : 'No',
    priv:     privChk.checked ? 'S√≠' : 'No',
    ts:       new Date().toISOString()
  };

  // Validaciones
  if(!data.nombre||!data.telefono||!data.email||!data.calle||!data.numext||!data.colonia||!data.municipio||!data.estado||!data.cp){
    alert('Por favor completa todos los campos obligatorios.'); return;
  }
  if(!/^\d{10}$/.test(data.telefono)){ alert('Tel√©fono debe tener 10 d√≠gitos.'); return; }
  if(!/^\d{5}$/.test(data.cp)){ alert('C√≥digo postal debe tener 5 d√≠gitos.'); return; }
  if(!privChk.checked){ alert('Debes aceptar Pol√≠ticas y Aviso de privacidad para registrarte.'); return; }

  // Si elige Concesionario/Mayorista/Distribuidor y NO acepta contrato ‚Üí se registra como Minorista
  let downgraded = false;
  if (data.tipo !== 'Minorista' && !contratoChk.checked){
    downgraded = true;
    data.tipo = 'Minorista';
    alert('No aceptaste el contrato. Tu registro se guardar√° como "Minorista".');
  }

 // Sin guardado en esta p√°gina ‚Äî Itzel gestiona la base externamente.
 // (No Apps Script, no localStorage)

  // Enviar correo (mailto)
  const contratoInfo = (data.tipo==='Minorista' && downgraded)

    ? 'Contrato: No aceptado. Registrado como MINORISTA por pol√≠tica.'
    : `Contrato: ${data.tipo==='Minorista'?'No aplica':(contratoChk.checked?'Aceptado':'No aceptado')}`;

  const cuerpo =
`Nuevo registro Miyotl

Nombre: ${data.nombre}
Tel√©fono: ${data.telefono}
Email: ${data.email}

Direcci√≥n:
  Calle: ${data.calle}
  No. ext: ${data.numext}
  No. int: ${data.numint||'-'}
  Colonia: ${data.colonia}
  Municipio/Alcald√≠a: ${data.municipio}
  Estado: ${data.estado}
  C.P.: ${data.cp}

Tipo de cliente: ${data.tipo}
${contratoInfo}
Promociones/boletines: ${data.promos}
Acepta Pol√≠ticas y Aviso: ${data.priv}

Fecha/Hora: ${new Date().toLocaleString('es-MX')}
`;

  const subject = encodeURIComponent('Registro ‚Äî Miyotl');
  const body = encodeURIComponent(cuerpo);
  window.location.href = `mailto:${REG_MAIL}?subject=${subject}&body=${body}`;

  // Mensaje de confirmaci√≥n
  regResult.style.display = '';
  regResult.innerHTML = `<strong>¬°Listo! üéâ</strong> Tu registro se envi√≥. En <strong>24 horas</strong> recibir√°s la confirmaci√≥n por correo electr√≥nico.`;
});

// Limpiar formulario
regClear?.addEventListener('click', ()=>{
  regForm.reset();
  promosChk.checked = false;
  contratoChk.checked = false;
  refreshContratoUI();
});

  document.getElementById('year').textContent = new Date().getFullYear();
</script>
</body>
</html>




